+------+----------------------------------------------------------------------------------------------------------+----+
|      |                                                                                                          |    |
+======+:========================================================================================================:+====+
|      | **User Requirements**                                                                                    |    |
|      |                                                                                                          |    |
|      | **SGP GENERATOR -- FULL RESPONSIVE**                                                                     |    |
+------+----------------------------------------------------------------------------------------------------------+----+
|      |                                                                                                          |    |
+------+----------------------------------------------------------------------------------------------------------+----+
|      |                                                                                                          |    |
+------+----------------------------------------------------------------------------------------------------------+----+
|      |                                                                                                          |    |
+------+----------------------------------------------------------------------------------------------------------+----+

+-------------------------------------------+:-------------------:+:------------:+:----------------------------------:+
| **Ciclo di emissione**                    | **Acronimi**        | **Data**     | **Firma**                          |
+-------------------------------------------+---------------------+--------------+------------------------------------+
| Redatto da:\                              | Sportsbook          | 15/03/2024   |                                    |
| Marco Rebuglio                            | Experience Manager  |              |                                    |
|                                           |                     |              |                                    |
| Domenico Romeo                            | Sportsbook Platform |              |                                    |
|                                           | Specialist          |              |                                    |
+-------------------------------------------+---------------------+--------------+------------------------------------+
| Verificato da:                            |                     |              |                                    |
+-------------------------------------------+---------------------+--------------+------------------------------------+
| Approvato da:                             |                     |              |                                    |
+-------------------------------------------+---------------------+--------------+------------------------------------+

+:----------:+:----------------------------------------------------------------------------:+:-----------------------:+
| **Rev.     | **Oggetto della revisione**                                                  | **Data**                |
| N.**       |                                                                              |                         |
+------------+------------------------------------------------------------------------------+-------------------------+
| 1.0        | Prima emissione                                                              | 15/03/2024              |
|            |                                                                              |                         |
| 1.1        | Integrazione a par 2.1.2 e 2.1.2.1                                           | 28/03/2024              |
+------------+------------------------------------------------------------------------------+-------------------------+

# Sommario {#sommario .TOC-Heading}

[1 Introduzione [3](#introduzione)](#introduzione)

[2 Requisiti [4](#requisiti)](#requisiti)

[2.1 Carosello Home Page [4](#carosello-home-page)](#carosello-home-page)

[2.1.1 Carosello HP - Condizioni di visualizzazione
[4](#carosello-hp---condizioni-di-visualizzazione)](#carosello-hp---condizioni-di-visualizzazione)

[2.1.2 Carosello HP - Struttura singola card/precompilata
[4](#carosello-hp---struttura-singola-cardprecompilata)](#carosello-hp---struttura-singola-cardprecompilata)

[2.1.3 Memorizzazione in cache delle precompilate
[6](#memorizzazione-in-cache-delle-precompilate)](#memorizzazione-in-cache-delle-precompilate)

[2.1.4 Skeleton Home Page [6](#skeleton-home-page)](#skeleton-home-page)

[2.2 Carosello in Dettaglio Avvenimento (Tab Bet Builder)
[6](#carosello-in-dettaglio-avvenimento-tab-bet-builder)](#carosello-in-dettaglio-avvenimento-tab-bet-builder)

[2.2.1 Carosello Dett Avv -- Condizioni di visualizzazione
[6](#carosello-dett-avv-condizioni-di-visualizzazione)](#carosello-dett-avv-condizioni-di-visualizzazione)

[2.2.2 Carosello Dett Avv -- Struttura Card Precompilata
[7](#carosello-dett-avv-struttura-card-precompilata)](#carosello-dett-avv-struttura-card-precompilata)

[2.2.3 Memorizzazione in cache delle precompilate su avvenimento
[7](#memorizzazione-in-cache-delle-precompilate-su-avvenimento)](#memorizzazione-in-cache-delle-precompilate-su-avvenimento)

[2.3 DWH [7](#dwh)](#dwh)

# Introduzione

Il presente documento contiene i requisiti per l'integrazione sui frontend di gioco Betting Full Responsive delle
precompilate di tipo Same Game Parlay generate randomicamente dal motore SGP Generator.

Gli sviluppi impattano il Full Responsive sia online che retail sia nella versione Italia che nella versione Marocco.

# Requisiti

## Carosello Home Page

In Home page deve essere visualizzato un carosello dal titolo *Bet Builder in evidenza / Bet Builder en vedette*. Sotto
il Carosello sono presenti 2 item *Calcio / Football* e *Basket*.

Se è selezionato l'item Calcio il carosello si deve comporre con le card delle scommesse precompilate SGP (generate dal
motore di BE) dedicate alla scommessa Calcio

Se è selezionato l'item Basket il carosello si deve comporre con le card delle scommesse precompilate SGP (generate dal
motore di BE) dedicate alla scommessa Basket

Il carosello *Bet Builder in evidenza / Bet Builder en vedette* in HP deve essere visualizzato sia su Full Responsive
online che su Full Responsive Retail

Su Full Responsive Retail, almeno fino a quando non sarà completata la migrazione a R2I, deve essere possibile attivare
o meno la presenza di tale carosello in HP. Tale configurazione dovrà essere possibile a caldo (ovvero senza rilascio)

### Carosello HP - Condizioni di visualizzazione

Se all'atterraggio sulla Home Page dal motore di backend non arriva alcuna precompilata (es: per la mancanza di market
type quotati in palinsesto) tale carosello non deve essere visualizzato

Se all'atterraggio sulla Home Page dal motore di backend non arriva alcuna precompilata Basket (es: per la mancanza di
market type quotati in palinsesto) il carosello si visualizza con il solo item Calcio

Se all'atterraggio sulla Home Page dal motore di backend non arriva alcuna precompilata Calcio (es: per la mancanza di
market type quotati in palinsesto) il carosello si visualizza con il solo item Basket

### Carosello HP - Struttura singola card/precompilata

Ogni precompilata che viene passata al frontend dal motore SGP Generator è composta dai seguenti elementi/informazioni

- Nome avvenimento con squadra 1 e squadra 2 in 2 stringhe separate

- Icona squadra 1 e Icona squadra 2 (saranno usate le icone settate nella sezione Squadre del redax)

- Data e ora avvenimento

- Icona disciplina

- Nome manifestazione

- Elenco pronostici: per ogni pronostico si riporta la descrizione del pronostico come da rimappatura su 2 stringhe
  eseguita dal business. La stringa 1 in alto e in bold, la stringa 2 sotto la stringa 1 in grigino (per le specifiche
  grafiche si vedano i Figma)\
  Su Full Responsive Italia dovrà essere visualizzata la rimappatura in italiano. Su Full Responsive Marocco dovrà
  essere visualizzata la rimappatura in francese

- Pulsante Quota: rappresenta la quota totale della scommessa proposta, ovvero il prodotto delle quote dei singoli esiti
  comprensiva di eventuale bonus multipla

Per le card dell'SGP Generatori il backend dovrà rendere disponibili anche le seguenti informazioni sull'avvenimento

- Numero di market quotati sull'avvenimento ad eccezione di quelli mostrati nella card (+ n)

- Eventuale presenza della diretta streaming sull'avvenimento (quando live)

NB: queste ultime 2 informazioni dovranno essere rese disponibili per le precompilate SGP su app

#### Pulsante quota

Al tap sul Pulsante quota questo si seleziona graficamente e tutti gli esiti proposti nella precompilata vengono messi a
carrello. Gli esiti proposti nella precompilata vengono comunque messi a carrello anche se questo aveva già esiti al suo
interno e anche se la presenza di esiti già a carrello e il successivo inserimento di esiti della precompilata porta il
biglietto in modalità sistema.

Se tutti gli esiti di una precompilata sono già presenti a carrello (o perché l'utente aveva in precedenza tappato sul
pulsante quota della precompilata, o perché quegli esiti l'utente li aveva selezionati in precedenza di sua sponte dal
palinsesto), il pulsante quota della precompilata deve risultare graficamente selezionato.

NB: se la precompilata contiene 4 esiti e a carrello ce ne sono solo 3 su 4, il pulsante quota nella card risulterà
disattivo

Il tap/click sul pulsante quota selezionato graficamente porta alla rimozione degli specifici esiti dal carrello e alla
deselezione grafica del pulsante quota stesso.

Se, al momento del tap sul pulsante quota della precompilata SGP, a carrello ci sono degli esiti che impediscono
l'inserimento completo a carrello della scommessa veicolata dalla card generator, non deve essere inserito a carrello
nessuno degli esiti del generator (a frontend sarà mostrato il classico messaggio di errore). Alcuni esempi qui sotto:

Esempio 1

- Nel carrello ci sono 3 esiti, di cui uno con leg max=5

- Nella precompilata ci sono 5 esiti

- L'utente tappa sul pulsante quota della precompilata

- Al tap della precompilata nessuno degli esiti in essa contenuti saranno portati a carrello e comparirà il messaggio di
  errore (nb: non ne verranno portati nemmeno 2)

Esempio 2

- Nel carrello ci sono 28 eventi in multipla

- Nella precompilata ci sono 5 esiti

- L'utente tappa sul pulsante quota della precompilata

- Al tap della precompilata nessuno degli esiti in essa contenuti saranno portati a carrello e comparirà il messaggio di
  errore di numero massimo eventi/Esiti raggiunto (nb: non verranno portati nemmeno 2 esiti della precompilata)

### Memorizzazione in cache delle precompilate

Le stesse card precompilate che l'utente vede quando apre il sito e atterra in homepage a T 0 devono essere tenute in
memoria per X minuti (l'X verrà comunicato da business a sviluppo per la fase di test e per il go live). Se quindi
l'utente atterra sul sito in HP, naviga il sito e poi torna in HP, al ritorno in HP, se questo avviene entro gli X
minuti definiti da business, deve ritrovare le stesse precompilate viste al primo atterraggio.

X può essere configurato NON a caldo ma con un rilascio.

#### Eventi da visualizzare nelle card

Tra gli eventi passati dal motore di BE, all'interno del carosello devono essere visualizzati solo quelli per cui non è
ancora stata sorpassata data e ora di inizio. Tornando quindi al caso di prima, se l'utente torna in HP prima degli X
minuti di scadenza della cache e durante la sua navigazione alcuni degli eventi proposti dal generator hanno passato
data e ora di inizio, al ritorno in HP l'utente vedrà solo le card relative ad eventi ancora non 'scaduti'.

Se al ritorno in HP dell'utente (prima degli X minuti di scadenza della cache) tutti gli eventi proposti dal motore SGP
sono scaduti allora il frontend deve rieffettuare una nuova chiamata al BE per farsi passare delle nuove precompilate
(dopo questa chiamata si resetteranno gli X minuti di cache)

### Skeleton Home Page

La conformazione dello skeleton in Home Page FR deve aggiornarsi con la presenza del nuovo carosello.

Poiché si prevedono periodi in cui tale Carosello non si vedrà (in estate, senza competizioni TOP di calcio) si chiede
che la presenza o meno nello skeleton di tale elemento sia configurabile a caldo (ovvero senza rilasci)

## Carosello in Dettaglio Avvenimento (Tab Bet Builder)

I requisiti contenuti in questo paragrafo valgono sia per la country Italia che per la country Marocco ma sono da
applicare solo sulla versione online del Full Responsive, non sulla versione retail (Prenotatore e Self).

Nel dettaglio avvenimento prematch, all'interno della Tab Bet Builder (quando presente per uno specifico avvenimento),
sopra l'area relativa alla SGP Experience deve comparire il carosello dal titolo *Bet Builder in evidenza / Bet Builder
en vedette*.

Sotto il titolo tale carosello deve presentare le scommesse SGP Precompilate dedicate allo specifico avvenimento fornite
dal motore di backend SGP Generator.

### Carosello Dett Avv -- Condizioni di visualizzazione

Il carosello Bet Builder in evidenza dedicato al singolo evento deve comparire (sopra l'area dedicata alla SGP
Experience) solo

- nelle schermate di dettaglio degli avvenimenti facenti parte di manifestazioni per cui da redax (nella sezione SGP
  Generator) è stata attivata la creazione di giocate SGP precompilate

- se per lo specifico avvenimento il motore di BE passa al frontend delle precompilate (potrebbe non passarle per
  mancanza di market sgp quotati nello specifico momento)

### Carosello Dett Avv -- Struttura Card Precompilata

Ogni precompilata sull'avvenimento specifico che viene passata al frontend dal motore SGP Generator è composta dai
seguenti elementi/informazioni

- Elenco pronostici: per ogni pronostico si riporta la descrizione del pronostico come da rimappatura su 2 stringhe
  eseguita dal business. La stringa 1 in alto e in bold, la stringa 2 sotto la stringa 1 in grigino (per le specifiche
  grafiche si vedano i Figma)\
  Su Full Responsive Italia dovrà essere visualizzata la rimappatura in italiano. Su Full Responsive Marocco dovrà
  essere visualizzata la rimappatura in francese

- Pulsante Quota: rappresenta la quota totale della scommessa proposta, ovvero il prodotto delle quote dei singoli esiti
  comprensiva di eventuale bonus multipla. Per la gestione delle interazioni sul pulsante quota vale quanto normato nel
  par 2.1.2.1

### Memorizzazione in cache delle precompilate su avvenimento

Le stesse card precompilate che l'utente vede quando atterra sul dettaglio di uno specifico avvenimento a T 0 devono
essere tenute in memoria per X minuti (l'X verrà comunicato da business a sviluppo per la fase di test e per il go
live). Se quindi l'utente atterra sul dettaglio di uno specifico avvenimento, naviga il sito e poi torna su quel
dettaglio, al ritorno su quel dettaglio, se questo avviene entro gli X minuti definiti da business, deve ritrovare le
stesse precompilate viste al primo atterraggio.

## DWH 

Devono essere infine effettuate le implementazioni necessarie per consentire il tracciamento DWH delle giocate
provenienti da Card SGP precompilate secondo quanto normato nel documento DWH_SGP Generator (SN: PRJ0011767)
